USE SNOWFLAKE
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DIM_TECHNICIAN]') AND type in (N'U'))
DROP TABLE [dbo].DIM_TECHNICIAN
GO

SELECT * 
INTO DIM_TECHNICIAN
FROM OPENQUERY([NABLESNOWFLAKE], 'SELECT TENANT_DK
	  ,USER_DK
	  ,CUSTOMER_DK
	  ,CAST(SUBSTRING(BIZ_APPS_CUST_ID,1,8000) AS CHAR(8000)) AS BIZ_APPS_CUST_ID
	  ,CAST(SUBSTRING(SYSTEM_GUID,1,8000) AS CHAR(8000)) AS SYSTEM_GUID
	  ,CLIENT_ID
	  ,USER_ID
	  ,CAST(SUBSTRING(USER_NAME,1,8000) AS CHAR(8000)) AS USER_NAME
	  ,USER_DELETED
	  ,IS_ENABLED
	  ,CAST(SUBSTRING(FULL_NAME,1,8000) AS CHAR(8000)) AS FULL_NAME
	  ,CAST(SUBSTRING(FIRST_NAME,1,8000) AS CHAR(8000)) AS FIRST_NAME
	  ,CAST(SUBSTRING(LAST_NAME,1,8000) AS CHAR(8000)) AS LAST_NAME
	  ,CAST(SUBSTRING(EMAIL,1,8000) AS CHAR(8000)) AS EMAIL
	  ,CAST(SUBSTRING(TITLE,1,8000) AS CHAR(8000)) AS TITLE
	  ,CAST(SUBSTRING(DEPARTMENT,1,8000) AS CHAR(8000)) AS DEPARTMENT
	  ,IS_PRIMARY
	  ,CAST(SUBSTRING(PHONE1,1,8000) AS CHAR(8000)) AS PHONE1
	  ,CAST(SUBSTRING(PHONE2,1,8000) AS CHAR(8000)) AS PHONE2
	  ,CAST(SUBSTRING(ADDRESS1,1,8000) AS CHAR(8000)) AS ADDRESS1
	  ,CAST(SUBSTRING(ADDRESS2,1,8000) AS CHAR(8000)) AS ADDRESS2
	  ,CAST(SUBSTRING(CITY,1,8000) AS CHAR(8000)) AS CITY
	  ,CAST(SUBSTRING(STATE_PROVINCE,1,8000) AS CHAR(8000)) AS STATE_PROVINCE
	  ,CAST(SUBSTRING(POSTALCODE,1,8000) AS CHAR(8000)) AS POSTALCODE
	  ,CAST(SUBSTRING(COUNTRY,1,8000) AS CHAR(8000)) AS COUNTRY
	  ,LAST_UPDATED
	  ,DSS_IS_DELETE
	  ,DSS_CREATED
	  ,DSS_UPDATED
	FROM SHARED_ANALYTICS_DATA.SHARED_DATA.DIM_TECHNICIAN')
