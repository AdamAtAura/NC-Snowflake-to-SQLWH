--DIM_END_TIME
USE SNOWFLAKE
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DIM_END_TIME]') AND type in (N'U'))
DROP TABLE [dbo].[DIM_END_TIME]
GO

SELECT * 
INTO DIM_END_TIME
FROM OPENQUERY([NABLESNOWFLAKE], 'SELECT END_TIME_SK
	  ,CAST(SUBSTRING(END_TIME_KEY,1,8000) AS CHAR(8000)) AS END_TIME_KEY
	  ,CAST(SUBSTRING(END_HOUR_24,1,8000) AS CHAR(8000)) AS END_HOUR_24
	  ,CAST(SUBSTRING(END_HOUR_24_LONG,1,8000) AS CHAR(8000)) AS END_HOUR_24_LONG
	  ,CAST(SUBSTRING(END_HOUR_12,1,8000) AS CHAR(8000)) AS END_HOUR_12
	  ,CAST(SUBSTRING(END_HOUR_12_LONG,1,8000) AS CHAR(8000)) AS END_HOUR_12_LONG
	  ,CAST(SUBSTRING(END_AM_PM,1,8000) AS CHAR(8000)) AS END_AM_PM
	  ,CAST(SUBSTRING(END_HALF_HOUR_24,1,8000) AS CHAR(8000)) AS END_HALF_HOUR_24
	  ,CAST(SUBSTRING(END_HALF_HOUR_24_LONG,1,8000) AS CHAR(8000)) AS END_HALF_HOUR_24_LONG
	  ,CAST(SUBSTRING(END_QUARTER_HOUR_24,1,8000) AS CHAR(8000)) AS END_QUARTER_HOUR_24
	  ,CAST(SUBSTRING(END_QUARTER_HOUR_24_LONG,1,8000) AS CHAR(8000)) AS END_QUARTER_HOUR_24_LONG
	FROM SHARED_ANALYTICS_DATA.SHARED_DATA.DIM_END_TIME')

