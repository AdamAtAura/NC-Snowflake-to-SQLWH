USE SNOWFLAKE
GO

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[DIM_TIME]') AND type in (N'U'))
DROP TABLE [dbo].DIM_TIME
GO

SELECT * 
INTO DIM_TIME
FROM OPENQUERY([NABLESNOWFLAKE], 'SELECT TIME_SK
	  ,CAST(SUBSTRING(TIME_KEY,1,8000) AS CHAR(8000)) AS TIME_KEY
	  ,CAST(SUBSTRING(HOUR_24,1,8000) AS CHAR(8000)) AS HOUR_24
	  ,CAST(SUBSTRING(HOUR_24_LONG,1,8000) AS CHAR(8000)) AS HOUR_24_LONG
	  ,CAST(SUBSTRING(HOUR_12,1,8000) AS CHAR(8000)) AS HOUR_12
	  ,CAST(SUBSTRING(HOUR_12_LONG,1,8000) AS CHAR(8000)) AS HOUR_12_LONG
	  ,CAST(SUBSTRING(AM_PM,1,8000) AS CHAR(8000)) AS AM_PM
	  ,CAST(SUBSTRING(HALF_HOUR_24,1,8000) AS CHAR(8000)) AS HALF_HOUR_24
	  ,CAST(SUBSTRING(HALF_HOUR_24_LONG,1,8000) AS CHAR(8000)) AS HALF_HOUR_24_LONG
	  ,CAST(SUBSTRING(QUARTER_HOUR_24,1,8000) AS CHAR(8000)) AS QUARTER_HOUR_24
	  ,CAST(SUBSTRING(QUARTER_HOUR_24_LONG,1,8000) AS CHAR(8000)) AS QUARTER_HOUR_24_LONG
	FROM SHARED_ANALYTICS_DATA.SHARED_DATA.DIM_TIME')
